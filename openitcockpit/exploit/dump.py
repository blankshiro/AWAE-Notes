import os
from db import create_connection, get, get_unique

database = r"sqlite.db"
contentDir = os.getcwd() + "/content"

def write_to_file(url, content):
    fileName = url.replace('https://','')
    if not fileName.endswith(".html"):
        fileName = fileName + ".html"
    fullname = os.path.join(contentDir, fileName)
    path, basename = os.path.split(fullname)
    if not os.path.exists(path):
        os.makedirs(path)
    with open(fullname, 'w') as f:
        f.write(content)

        
if __name__ == '__main__':
    conn = create_connection(database)
    urls = get_unique(conn,'content','url')
    for url in urls:
        content = get(conn,'content', 'html','url', url[0])
        for c in content:
            print(type(c))
            write_to_file(url[0], c[0])